---
title: "Rpackage"
author: "Andrew Liu"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Rpackage}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
Install \texttt{Rpackage} using:
```{r, eval = FALSE}
devtools::install_github("Zhaoyu-Andrew/Rpackage")
```
To begin, we load our example data set as a \texttt{gapminder} object.

```{r, message = FALSE}
library(Rpackage)
```
If you are unfamiliar with \texttt{my_gapminder}, we can view a description of the data using:

```{r}
head(my_gapminder)
```
# Fitting a t-test
Now, let's set up our model. 
First, let's subset our samples to only include lifeExp covariate
```{r}
life_Exp <- my_gapminder[[4]]
my_t.test(life_Exp, "two.sided", 60)

my_t.test(life_Exp, "less", 60)

my_t.test(life_Exp, "greater", 60)
```
# Interpreting the result of the t-test

Test 1: 
  for the two-sided test, since the p-value 0.09322877 is greater than the cut-off value of α =0.05,
  we conclude that we fail to reject the null hypothesis, therefore, there is not sufficient evidence to
  support a conclusion that the population mean differs from a life expectancy of 60 years. 
  
Test 2:
  for the left-sided test, since the p-value 0.04661438 is less than the cut-off value of α =0.05,
  we reject the null hypothesis, therefore, there is enough evidence to support a conclusion that the 
  population mean is less than a life expectancy of 60 years. 
  
Test 3:
  for the right-sided test, since the p-value 0.9533856 is greater than the cut-off value of α =0.05,
  we conclude that we fail to reject the null hypothesis, therefore, there is not sufficient evidence to
  support a conclusion that the population mean is greater than a life expectancy of 60 years. 
```{r}
library(ggplot2)
library(tidyverse)
gdp_Percap <- my_gapminder[[6]]
continent <- my_gapminder[[2]]
life_Exp <- my_gapminder[[4]]
test <- my_lm(life_Exp ~ gdp_Percap + continent, data = my_gapminder)
my_coef <- test[, 1]
my_matrix <- model.matrix(life_Exp ~ gdp_Percap + continent, data = my_gapminder)
y_hat <- my_matrix %*% as.matrix(my_coef)

my_data <- data.frame("Actual" = my_gapminder$lifeExp,
                      "Fitted" = y_hat,
                      "Continent" = my_gapminder$continent)

ggplot(my_data, aes(x = Actual, y = Fitted, color = Continent)) +
  geom_point() 

```

# reject null hypothesis = 0
```{r}
test <- my_knn_cv(my_gapminder, my_gapminder$continent, 1, 5)
result <- matrix(NA, nrow = 2, ncol = 10)

for(i in 1:10) {
  test_i <- my_knn_cv(my_gapminder, my_gapminder$continent, i, 5)
  result[1, i] <- test_i$cv_error
  accuracy <- function(x){sum(diag(x)/(sum(rowSums(x)))) * 100}
  tab_i <- table(test_i$class, my_gapminder$continent)
  training_set_error_k_nn <- round((100 - accuracy(tab_i)) / 100, digit = 2)
  result[2, i] <- training_set_error_k_nn
}


```
```{r}
library(ggplot2)

```
